import os
import matplotlib.pyplot as plt
import cv2
print os.getcwd()
os.chdir('/home/feixuan/caffe-master')
print os.getcwd()
import caffe
net=caffe.Classifier('/home/feixuan/caffe-master/data/fp/deproy.prototxt','/home/feixuan/caffe-master/data/fp/temp_iter_10000.caffemodel')
net.set_phase_test()
net.set_mode_gpu()
##img=cv2.imread('9.jpg');
##img=cv2.cvtColor(img,cv2.COLOR_BGR2GRAY)
img=caffe.io.load_image('9.jpg',False)
prediction = net.predict([img])
print 'prediction shape:', prediction[0].shape
points=prediction[0]
recoverfacepoint=points
s=39;
recoverfacepoint[0::2]=[int(j*39.0/2+39.0/2) for j in points[0::2]]
recoverfacepoint[1::2]=[int(j*39.0/2+39.0/2) for j in points[1::2]]
face=caffe.io.load_image('9.jpg',True)

cv2.circle(face,(recoverfacepoint[0],recoverfacepoint[1]),1,(255,0,0),1)
cv2.imshow('face',face)
cv2.waitKey(0)
cv2.destroyAllWindows()

cv2.circle(face,(recoverfacepoint[2],recoverfacepoint[3]),1,(255,0,0),1)
cv2.imshow('face',face)
cv2.waitKey(0)
cv2.destroyAllWindows()

cv2.circle(face,(recoverfacepoint[4],recoverfacepoint[5]),1,(255,0,0),1)
cv2.imshow('face',face)
cv2.waitKey(0)
cv2.destroyAllWindows()

cv2.circle(face,(recoverfacepoint[6],recoverfacepoint[7]),1,(255,0,0),1)
cv2.circle(face,(recoverfacepoint[8],recoverfacepoint[9]),1,(255,0,0),1)
                        
cv2.imshow('face',face)
cv2.waitKey(0)
cv2.destroyAllWindows()
